:root{
  --bg: #0b1220;
  --panel: rgba(255,255,255,0.03);
  --accent-1: #7b61ff;
  --accent-2: #2b6ef6;
  --muted: rgba(255,255,255,0.70); /* body / primary text (dark theme) */
  --text: #e6eef8; /* on-surface text color (dark theme) */
  --text-secondary: rgba(255,255,255,0.50); /* secondary text */
  --border: rgba(255,255,255,0.06); /* subtle adaptive border */
  --surface: rgba(255,255,255,0.02); /* surface tints */
  --user: #0b84ff;
  --primary: #0b84ff;
  --primary-light: rgba(11,132,255,0.15);
  --glass: rgba(255,255,255,0.03);
  --overlay: rgba(20,24,31,0.65);
}
/* Light theme overrides */
.theme-light {
  --bg: linear-gradient(180deg, #f6f8fb 0%, #eef3fa 100%);
  --panel: rgba(2,6,23,0.03);
  --accent-1: #5a3dff;
  --accent-2: #2b6ef6;
  --muted: rgba(12,20,34,0.72); /* primary text (light theme) */
  --text: #0c1422; /* on-surface text color (light theme) */
  --text-secondary: rgba(12,20,34,0.50); /* secondary text */
  --border: rgba(12,20,34,0.08);
  --surface: rgba(255,255,255,0.96); /* opaque light surface for dialogs/panels */
  --user: #0b84ff;
  --primary: #0b84ff;
  --primary-light: rgba(11,132,255,0.12);
  --glass: rgba(2,6,23,0.03);
  --overlay: rgba(2,6,23,0.06);
}
.theme-dark{ }
body {
  margin: 0;
  font-family: 'Plus Jakarta Sans', Inter, system-ui, Arial, sans-serif;
  background: var(--bg);
  color: var(--muted);
}

/* For dark theme default background keep original gradients */
.theme-dark body, :root:not(.theme-light) body {
  background: radial-gradient(1200px 500px at 10% 10%, rgba(123,97,255,0.08), transparent 8%), radial-gradient(900px 400px at 90% 90%, rgba(43,110,246,0.06), transparent 12%), linear-gradient(180deg, #061025 0%, #071022 100%);
  color: var(--text);
}

/* Light body background */
.theme-light body {
  background: var(--bg);
  color: #0c1422;
}
html, body, #root {
  height: 100%;
}
/* Chat area */
.chat-root{
  display:flex;
  flex-direction:column;
  height:100%;
  border-radius:8px;
  overflow:hidden;
  background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));
}

.chat-toolbar{display:flex;align-items:center;gap:12px;padding:12px 20px;border-bottom:1px solid var(--border)}
.export-btn{
  padding:8px 12px;
  border-radius:10px;
  background: var(--surface); /* adaptive surface */
  color: var(--text);
  border: 1px solid var(--border);
  cursor: pointer;
  font-weight:600;
  transition: background .12s ease, color .12s ease, border-color .12s ease;
}
.export-btn:hover{
  background: color-mix(in srgb, var(--surface) 70%, var(--accent-2) 30%);
  color: var(--text);
  border-color: var(--border);
}
.chat-notice{margin-left:8px;color:var(--muted);font-size:13px}
.messages{
  flex:1 1 auto;
  padding:20px;
  overflow:auto;
  display:flex;
  flex-direction:column;
  gap:14px;
}
.composer{
  display:flex;
  gap:8px;
  padding:14px;
  border-top:1px solid var(--border);
  /* center the composer pill vertically by default */
  align-items:center;
}

/* Message rows */
.message-row{display:flex;align-items:flex-end;gap:10px}
.message-row.assistant{justify-content:flex-start}
.message-row.user{justify-content:flex-end}
.avatar{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:600}
.avatar.bot{background:linear-gradient(135deg,#2b6ef6,#7b61ff);color:white}
.avatar.bot img{width:100%;height:100%;object-fit:cover;border-radius:8px;display:block}
.avatar.user{background:#0b84ff;color:#fff}

.bubble{
  max-width:75%;
  padding:12px 14px;
  border-radius:12px;
  background: var(--surface);
  border: 1px solid var(--border);
  box-shadow: 0 8px 20px rgba(2,6,23,0.12);
  color: var(--text);
  /* smooth transitions for pop/fade */
  transition: transform .18s cubic-bezier(.2,.9,.2,1), opacity .18s ease, box-shadow .18s ease;
}

/* typing placeholder bubble */
.bubble.typing{
  /* slightly muted surface for typing */
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px dashed color-mix(in srgb, var(--border) 70%, rgba(255,255,255,0.04) 30%);
  color: var(--muted);
}
.bubble.typing .typing-dots{display:inline-flex;gap:6px;align-items:center}
.bubble.typing .typing-dots span{width:6px;height:6px;border-radius:50%;background:currentColor;opacity:0.85;transform:translateY(0);animation:typing 1s linear infinite}
.bubble.typing .typing-dots span:nth-child(2){animation-delay:0.15s}
.bubble.typing .typing-dots span:nth-child(3){animation-delay:0.3s}
@keyframes typing{0%{opacity:.2;transform:translateY(0)}50%{opacity:1;transform:translateY(-6px)}100%{opacity:.2;transform:translateY(0)}}

/* pop-in animation for newly added messages */
@keyframes popIn {
  from { opacity: 0; transform: translateY(8px) scale(0.995); }
  to   { opacity: 1; transform: translateY(0) scale(1); }
}

/* slideDown animation for dropdown menu */
@keyframes slideDown {
  from { opacity: 0; transform: translateY(-8px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* apply pop-in only when element has is-entering class */
.bubble.is-entering{ animation: popIn .22s cubic-bezier(.2,.9,.25,1) both; }

/* subtle hover/active lift for bubbles */
.bubble:hover{ transform: translateY(-2px); box-shadow: 0 14px 36px rgba(2,6,23,0.14); }
.bubble-bot{
  background: linear-gradient(180deg, rgba(255,255,255,0.045), rgba(255,255,255,0.01));
  border: 1px solid var(--border);
  box-shadow: 0 10px 30px rgba(43,110,246,0.06);
  color: var(--text);
}
.bubble-user{background:linear-gradient(180deg,#0b84ff,#0667d6);color:#fff}
.bubble-text{white-space:pre-wrap}
.bubble-meta{font-size:11px;opacity:0.7;margin-top:6px;text-align:right}

/* small AI label inside assistant bubble */
.bubble-badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  min-width:34px;
  height:24px;
  padding:0 8px;
  border-radius:8px;
  background:linear-gradient(90deg,var(--accent-1),var(--accent-2));
  color:#fff;
  font-weight:700;
  font-size:12px;
  margin-bottom:8px;
  box-shadow:0 6px 12px rgba(43,110,246,0.12);
}

/* App layout styles */
.app-wrapper{
  display:flex;
  justify-content:center;
  align-items:stretch;
  padding:24px 16px;
  height:100vh;
}
.app-card{
  width:100%;
  max-width:1400px;
  height:calc(100vh - 48px);
  background: var(--surface);
  border-radius:12px;
  box-shadow: 0 2px 12px rgba(2,6,23,0.12);
  overflow:hidden;
  display:flex;
  flex-direction:column;
}
.app-header{
  padding:18px 20px;
  border-bottom: 1px solid var(--border);
  display:flex;align-items:center;justify-content:space-between;gap:12px;
}
.header-actions{display:flex;align-items:center;gap:12px}
.status-text{margin-left:8px;color:var(--muted);font-size:13px;line-height:1}
.theme-toggle{display:inline-flex;align-items:center;justify-content:center;padding:6px;border-radius:999px;border:none;background:transparent;cursor:pointer;height:34px}
.theme-toggle:focus{outline:none}
.theme-toggle .switch-track{width:58px;height:30px;border-radius:999px;background:var(--surface);display:inline-block;position:relative;transition:background .18s ease;vertical-align:middle}
.theme-toggle .switch-knob{position:absolute;left:4px;top:4px;width:22px;height:22px;border-radius:50%;background:#fff;box-shadow:0 6px 12px rgba(2,6,23,0.32);transition:transform .18s ease, background .18s ease}
.theme-toggle .switch-icon{position:absolute;top:50%;transform:translateY(-50%);font-size:13px;opacity:0.6;transition:opacity .12s ease, transform .12s ease;color:var(--muted)}
.theme-toggle .switch-icon-left{left:8px}
.theme-toggle .switch-icon-right{right:8px}
.theme-toggle.is-dark .switch-track{background:linear-gradient(90deg,var(--accent-1),var(--accent-2))}
.theme-toggle.is-dark .switch-knob{transform:translateX(28px);background:#fff}
.theme-toggle.is-dark .switch-icon-left{opacity:1;transform:translateY(-50%) scale(1.05)}
.theme-toggle.is-dark .switch-icon-right{opacity:0.45}
.theme-toggle:not(.is-dark) .switch-icon-left{opacity:0.45}
.theme-toggle:not(.is-dark) .switch-icon-right{opacity:1;transform:translateY(-50%) scale(1.05)}
.theme-toggle:focus .switch-track{box-shadow:0 0 0 4px rgba(123,97,255,0.08)}
.brand{display:flex;align-items:center;gap:12px}
.brand-logo{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;box-shadow:0 6px 18px rgba(11,132,255,0.08);}
.brand-logo img{width:100%;height:100%;object-fit:cover;border-radius:10px;display:block}
.brand-title{font-weight:700;font-size:16px}
.brand-sub{font-size:12px;opacity:0.75}
.app-body{padding:0}

/* Two-column layout */
.app-body--layout{display:flex;flex:1;min-height:0}
.sidebar{width:300px;border-right:1px solid var(--border);background:linear-gradient(180deg, rgba(255,255,255,0.012), transparent);display:flex;flex-direction:column}
.sidebar-top{padding:14px}
.new-chat{width:100%;padding:10px;border-radius:10px;background:linear-gradient(90deg,var(--accent-1),var(--accent-2));color:#fff;border:none;cursor:pointer;font-weight:600;display:flex;align-items:center;justify-content:center}
.conversations{padding:8px 10px;overflow:auto}
.conversation-item{padding:12px;border-radius:10px;margin-bottom:10px;background:transparent;cursor:pointer;border:1px solid var(--surface)}
.conversation-item:hover{background:linear-gradient(90deg, rgba(123,97,255,0.04), rgba(43,110,246,0.03));transform:translateY(-1px)}
.conv-title{font-weight:700}
.conv-last{font-size:12px;opacity:0.7;margin-top:6px}
.conversation-item{display:flex;align-items:center;justify-content:space-between;gap:10px}
.conv-body{flex:1;min-width:0;overflow:hidden}

/* When editing, hide delete button so the title input can expand */
.conversation-item.editing{gap:8px}
.conversation-item.editing .conv-delete{display:none}
.conversation-item.editing .conv-body{overflow:visible}

/* Modal confirm styles */
.modal-overlay{
  position:fixed;
  inset:0;
    background: var(--overlay);
  backdrop-filter: blur(8px); /* làm mờ nền phía sau modal */
  display:flex;
  align-items:flex-start;
  justify-content:center;
  padding-top:33vh;
  z-index:99999; /* increased so overlay sits above other UI elements */
}
.modal{
  background: var(--surface);
  color: var(--text);
  padding:18px;
  border-radius:12px;
  min-width:320px;
  max-width:90%;
  border: 1px solid var(--border);
  box-shadow:0 12px 40px rgba(2,6,23,0.12);
  position:relative;
  z-index:100000; /* ensure modal content is above overlay children */
}

/* When modal is open, remove any background blur/dim applied by other styles
   Ensure main content renders without additional filters so modal content reads clearly. */
body.modal-open .app-wrapper,
body.modal-open .app-card,
body.modal-open .messages,
body.modal-open .sidebar,
body.modal-open .conversation-item {
  filter: none !important;
  opacity: 1 !important;
}
.modal-title{font-weight:700;margin-bottom:8px;color:var(--text)}
.modal-body{font-size:13px;opacity:1;margin-bottom:14px}
.modal-actions{display:flex;justify-content:flex-end;gap:10px}
.btn{padding:8px 12px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
.btn-secondary{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.04)}
.btn-secondary:hover{background:rgba(255,255,255,0.02)}
.btn-danger{background:linear-gradient(90deg,var(--accent-1),var(--accent-2));color:#fff}
.btn-danger:hover{filter:brightness(1.05)}
.conv-title-input{
  width:100%;
  box-sizing:border-box;
  display:block;
  padding:6px 10px;
  height:36px;
  border-radius:8px;
  border:1px solid var(--border);
  background: linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.008));
  color:var(--muted);
  font-size:14px;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
  outline:none;
  transition:box-shadow .15s ease, border-color .12s ease, background .12s ease;
}
.conv-title-input:focus{
  border-color: rgba(123,97,255,0.9);
  color: var(--text);
  box-shadow: 0 6px 18px rgba(43,110,246,0.12);
  background: linear-gradient(180deg, rgba(123,97,255,0.02), rgba(43,110,246,0.01));
}
.conv-delete{
  width:36px;
  height:36px;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  background:var(--surface);
  border:1px solid var(--border);
  color:var(--muted);
  padding:0;
  border-radius:10px;
  cursor:pointer;
  transition:transform .16s ease, box-shadow .16s ease, background .16s ease, color .16s ease;
}
.conv-delete:hover{
  color:var(--text);
  background:linear-gradient(90deg,var(--accent-1),var(--accent-2));
  transform:translateY(-2px) scale(1.02);
  box-shadow:0 6px 18px rgba(43,110,246,0.12);
}
.conv-delete:focus{outline:none;box-shadow:0 0 0 4px rgba(43,110,246,0.12)}
.conv-delete svg{width:14px;height:14px}
.conversation-item.active{background:linear-gradient(90deg, rgba(123,97,255,0.06), rgba(43,110,246,0.04));border-color:rgba(123,97,255,0.08)}
.sidebar-footer{margin-top:auto;padding:12px;font-size:12px;opacity:0.6}

.main-chat{flex:1;padding:22px;display:flex;flex-direction:column;min-width:0}

/* Composer input */
.composer-pill{display:flex;align-items:center;gap:8px;background:var(--surface);padding:8px;border-radius:999px;width:100%;border:1px solid var(--border);transition:box-shadow .12s ease, border-color .12s ease}
.composer-pill:focus-within{box-shadow:0 6px 24px rgba(43,110,246,0.12);border-color:color-mix(in srgb, var(--accent-2) 50%, var(--border) 50%)}
.composer-pill.is-multiline{align-items:flex-start;border-radius:12px}
/* when pill becomes multiline, allow it to align to the top of the composer area */
.composer-pill.is-multiline{align-self:flex-start}

/* single-line composer: vertically center the text within the textarea */
.composer-pill:not(.is-multiline) .composer-input{
  height:36px;
  line-height:36px;
  padding-top:0;
  padding-bottom:0;
}
.pill-add{background:transparent;border:none;color:var(--muted);padding:6px 10px;border-radius:8px;cursor:pointer;font-size:18px;align-self:center}
.pill-add:hover{color:#fff}
.composer-input{flex:1;padding:8px 12px;border-radius:12px;border:none;background:transparent;color:inherit;outline:none;font-size:14px;line-height:20px;resize:none;min-height:36px;max-height:220px;overflow:auto;font-family:inherit;vertical-align:top}
.pill-actions{display:flex;align-items:center;gap:8px;margin-left:8px;align-self:center}
.icon-btn{width:36px;height:36px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;border:none;background:transparent;color:var(--muted);cursor:pointer;align-self:center}
.icon-btn:hover{color:var(--text);background:var(--surface)}
.icon-btn.send{background:linear-gradient(90deg,var(--accent-2),var(--accent-1));color:#fff}
.icon-btn.send svg{filter:brightness(2)}
.icon-btn:disabled{opacity:0.5;cursor:not-allowed}
.upload-btn{padding:8px 10px;border-radius:8px;border:none;background:transparent;color:var(--muted);cursor:pointer;margin-right:8px}
.upload-btn:hover{color:#fff}

/* File preview message (rendered inside bubble) */
.file-preview{font-family:monospace;font-size:12px;white-space:pre-wrap;margin-top:8px;background:var(--surface);padding:8px;border-radius:6px}
